# 概念收纳

### 0. 命令

#### 0.1. ps

- ps - report a snapshot of the current processes

#### 0.2. du

- du - estimate file space usage
  - du -sh 文件夹，显示文件件占用空间大小

#### 0.3. aslias

- 添加别名
  - vim ~/.bashrc
  - aslias ll='ls -l'
  - source ~/.bashrc

#### 0.4. echo

- echo - display a line of text
  - -e     enable interpretation of backslash escapes
  - -n     do not output the trailing newline

#### 0.5. lsof

- lsof 文件，查看使用文件的程序
- lsof -p 进程号，查看进程使用的文件，包括so文件，和fd。

## 1. 进程

- 僵尸，孤儿进程都涉及到父子关系：linux的子进程是由父进程来创建和管理的，所以涉及到:
  - 丢失 -> 僵尸
  - 托管 -> 孤儿

### 僵尸进程<defunct>

1. 子进程先退出，父进程没有收尸(wait/waitpid)，资源被释放(虚拟内存、文件描述符)，但是PCB中残留了进程信息(`父进程获取后进行善后`)，占用了有限的进程数量；
    直到父进程退出，子进程由init收尸(`init进程在循环wait`)。

    *除init外的所有进程退出exit后，都会留下一个僵尸进程，等待父进程处理*
    
    杀死父进程，即可快速处理僵尸进程。
    
2. 收尸方式：
```c
//1. 注册子进程结束信号处理函数
signal(SIGCHLD);

//2.1. [信号处理函数内]收尸函数，阻塞形式，多子进程同时退出时，可能会导致部分进程未被收尸处理。
pid=wait(&status)

//2.2. [信号处理函数内]收尸函数，可以不阻塞(opt=WNOHANG)，接收所有子进程-1.
while ((pid=waitpid(-1, &status, WNOHANG)) > 0)

//2.x. 获取进程退出状态信息的宏函数：man waitpid进行查询
```

- 父进程先退出，确保init收尸。

### 孤儿进程<ppid init>

1. 父进程先退出，子进程变成孤儿进程，被init进程收养，即父进程变为init进程。

### 守护进程

- [参考](https://blog.csdn.net/mijichui2153/article/details/81394387)

1. 守护进程是**后台运行的**、**系统启动时**就存在的、**不与任何终端**关联的，用于处理一些系统级别任务的**特殊进程**。
2. 实现一个守护进程，其实就是将普通进程按照上述特性改造为守护进程的过程。
3. 

## 2. 同步异步

### 1. 进程：

- 互相阻塞，互相等待？
- 父进程和子进程是异步的，所以不知道其什么时候结束？

## 3. 阻塞和挂起

阻塞与挂起都是进程的状态，但他们有一些相似之处，也有一些区别，下面先对他们进行概述，再进行比较

**阻塞**：正在执行的进程由于发生某时间（如I/O请求、申请缓冲区失败等）暂时无法继续执行。此时引起进程调度，OS把处理机分配给另一个就绪进程，而让受阻进程处于暂停状态，一般将这种状态称为阻塞状态。

**挂起**：**pause()**由于系统和用户的需要引入了挂起的操作，进程被挂起意味着该进程处于静止状态。如果进程正在执行，它将暂停执行，若原本处于就绪状态，则该进程此时暂不接受调度。

**共同点**： 

1. 进程都暂停执行 
2. 进程都释放CPU，即两个过程都会涉及上下文切换

**不同点**： 

1. 对系统资源占用不同：

   ​	虽然都释放了CPU，但阻塞的进程仍处于**内存**中，

   ​	而挂起的进程通过“对换”技术被换出到**外存**（磁盘）中。 

2. 发生时机不同：

   ​	**阻塞**一般在进程**等待资源**（IO资源、信号量等）时发生；

   ​	而**挂起**是由于用户和系统的需要，例如，终端**用户需要**暂停程序研究其执行情况或对其进行修改、OS为了提高内存利用率需要将暂时不能运行的进程（处于就绪或阻塞队列的进程）调出到磁盘 

3. 恢复时机不同：

   阻塞要在等待的**资源得到满足**（例如获得了锁）后，才会进入就绪状态，等待被调度而执行；

   被挂起的进程由将其挂起的对象（如用户、系统）在**时机符合**时（调试结束、被调度进程选中需要重新执行）将其主动激活

